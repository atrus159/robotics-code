#pragma config(Hubs,  S1, HTMotor,  HTServo,  none,     none)
#pragma config(Sensor, S2,     msensor,        sensorI2CCustom)
#pragma config(Motor,  mtr_S1_C1_1,     rightMotor,    tmotorTetrix, openLoop, reversed, encoder)
#pragma config(Motor,  mtr_S1_C1_2,     leftMotor,     tmotorTetrix, openLoop, encoder)
#pragma config(Servo,  srvo_S1_C2_1,    servo1,               tServoNone)
#pragma config(Servo,  srvo_S1_C2_2,    servo2,               tServoNone)
#pragma config(Servo,  srvo_S1_C2_3,    servo3,               tServoNone)
#pragma config(Servo,  srvo_S1_C2_4,    servo4,               tServoNone)
#pragma config(Servo,  srvo_S1_C2_5,    servo5,               tServoNone)
#pragma config(Servo,  srvo_S1_C2_6,    servo6,               tServoNone)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

#include "JoystickDriver.c";
#include "hitechnic-sensormux.h";
#include "hitechnic-compass.h";
#include "lego-touch.h";
#include "lego-ultrasound.h";

int dist;
bool goLeft=false;
int compassOffset;	
task main()
{
	while(TSreadState(msensor_S2_2)==0)
	{
		dist=USreadDist(msensor_S2_1);
		goLeft = dist<15 || dist==255;
		if(goLeft){
			motor[leftMotor]=-50;
			motor[rightMotor]=-40;
	}
	else{
			motor[leftMotor]=-40;
			motor[rightMotor]=-50;
	}
	}
  compassOffset=HTMCreadHeading(msensor_S2_3);
  while(HTMCreadHeading(msensor_S2_3)-compassOffset<60){
  	  motor[leftMotor]=20;
			motor[rightMotor]=10;
  }
  compassOffset=HTMCreadHeading(msensor_S2_3);
  while(HTMCreadHeading(msensor_S2_3)-compassOffset>-60){
  	  motor[leftMotor]=10;
			motor[rightMotor]=20;
  }
  		while(true){
    	motor[leftMotor]=20;
			motor[rightMotor]=20;
		}
}
